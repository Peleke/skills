{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Persona Extract Output",
  "description": "Structured output from the persona-extract skill. Contains evidence-based buyer personas with real pain stories, success stories, decision point maps, Four Forces analysis, and next-step hints for offer-scope -- all grounded in real community evidence collected via web search.",
  "type": "object",
  "required": [
    "persona_id",
    "date",
    "domain",
    "opportunity",
    "personas",
    "four_forces_analysis",
    "meta_insight",
    "decision_ref",
    "signal_scan_ref",
    "next_step",
    "next_step_input_hint"
  ],
  "properties": {
    "persona_id": {
      "type": "string",
      "description": "Unique identifier for this persona extraction, e.g. 'persona-devops-education-2026-02-08'"
    },
    "date": {
      "type": "string",
      "format": "date",
      "description": "ISO 8601 date string"
    },
    "domain": {
      "type": "string",
      "description": "The domain researched (e.g. 'DevOps education', 'cybersecurity careers')"
    },
    "opportunity": {
      "type": "string",
      "description": "The specific opportunity from the decision log this extraction addresses"
    },
    "personas": {
      "type": "array",
      "minItems": 3,
      "maxItems": 4,
      "items": {
        "type": "object",
        "required": [
          "persona_name",
          "archetype",
          "demographics",
          "emotional_state",
          "pain_stories",
          "success_stories",
          "decision_points",
          "buying_triggers",
          "objections",
          "willingness_to_pay",
          "channels"
        ],
        "properties": {
          "persona_name": {
            "type": "string",
            "description": "Descriptive name encoding the emotional state or behavior pattern"
          },
          "archetype": {
            "type": "string",
            "description": "Short archetype label -- e.g., 'The Reluctant Senior', 'The Copypaste Engineer', 'The Midnight Firefighter'"
          },
          "demographics": {
            "type": "object",
            "required": ["job_titles", "experience_range", "salary_range", "company_size"],
            "properties": {
              "job_titles": {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "description": "Common job titles for this archetype"
              },
              "experience_range": {
                "type": "string",
                "description": "Years of experience range, e.g. '2-5 years', '5-10 years'"
              },
              "salary_range": {
                "type": "string",
                "description": "Approximate salary range for WTP anchoring, e.g. '$80K-120K'"
              },
              "company_size": {
                "type": "string",
                "description": "Typical company size, e.g. 'startup (10-50)', 'mid-market (200-1000)'"
              }
            }
          },
          "emotional_state": {
            "type": "string",
            "description": "The dominant emotional experience of this archetype -- in their language, not clinical terms"
          },
          "pain_stories": {
            "type": "array",
            "minItems": 3,
            "items": {
              "type": "object",
              "required": ["situation", "pain", "current_workaround", "emotional_state", "evidence"],
              "properties": {
                "situation": {
                  "type": "string",
                  "description": "What was happening when the pain occurred -- specific context, not abstract"
                },
                "pain": {
                  "type": "string",
                  "description": "What hurt -- the actual problem experienced, in their words"
                },
                "current_workaround": {
                  "type": "string",
                  "description": "What they do instead of a real solution -- reveals product opportunity"
                },
                "emotional_state": {
                  "type": "string",
                  "description": "How they feel about it -- use their emotional language"
                },
                "evidence": {
                  "type": "string",
                  "description": "REAL quote with attribution. Format: '\"quote text\" -- u/username on r/subreddit (N upvotes)' or '\"quote text\" -- @handle on Twitter'. Must be an actual quote from an actual post."
                }
              }
            }
          },
          "success_stories": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "object",
              "required": ["situation", "what_they_did", "outcome", "evidence"],
              "properties": {
                "situation": {
                  "type": "string",
                  "description": "Where they started -- what struggle they faced"
                },
                "what_they_did": {
                  "type": "string",
                  "description": "The specific actions that led to the breakthrough -- actions, not mindset shifts"
                },
                "outcome": {
                  "type": "string",
                  "description": "What changed as a result -- concrete and measurable when possible"
                },
                "evidence": {
                  "type": "string",
                  "description": "REAL quote with attribution. Same format as pain story evidence."
                }
              }
            }
          },
          "decision_points": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "object",
              "required": ["trigger", "stuck_behavior", "success_behavior", "product_intervention"],
              "properties": {
                "trigger": {
                  "type": "string",
                  "description": "What starts the search -- the specific event that moves someone from passive to active"
                },
                "stuck_behavior": {
                  "type": "string",
                  "description": "What the people who remain stuck do at this fork"
                },
                "success_behavior": {
                  "type": "string",
                  "description": "What the people who break through do at this fork"
                },
                "product_intervention": {
                  "type": "string",
                  "description": "What product could help the stuck person take the success path -- specific enough for offer-scope to act on"
                }
              }
            }
          },
          "buying_triggers": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "object",
              "required": ["trigger", "urgency", "channel"],
              "properties": {
                "trigger": {
                  "type": "string",
                  "description": "The specific event that would cause them to search for and purchase a solution"
                },
                "urgency": {
                  "type": "string",
                  "enum": ["low", "medium", "high", "critical"],
                  "description": "How time-sensitive this trigger is"
                },
                "channel": {
                  "type": "string",
                  "description": "Where the persona would be when this trigger fires -- the platform or context where they would search"
                }
              }
            }
          },
          "objections": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "object",
              "required": ["objection", "counter"],
              "properties": {
                "objection": {
                  "type": "string",
                  "description": "What would make them hesitate or say no"
                },
                "counter": {
                  "type": "string",
                  "description": "Evidence-based counter -- acknowledges the concern, then addresses it with evidence or structural guarantee"
                }
              }
            }
          },
          "willingness_to_pay": {
            "type": "object",
            "required": ["range", "evidence", "anchor_products"],
            "properties": {
              "range": {
                "type": "string",
                "description": "Price range this persona would pay, e.g. '$19-49', '$29-97'"
              },
              "evidence": {
                "type": "string",
                "description": "What supports this range -- must be anchored to SPEND data, not guesses"
              },
              "anchor_products": {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "description": "Specific products/services this persona already pays for that anchor the price range"
              }
            }
          },
          "channels": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "object",
              "required": ["platform", "behavior", "estimated_reach"],
              "properties": {
                "platform": {
                  "type": "string",
                  "description": "Specific platform where this persona spends time -- e.g., 'r/devops', 'Hacker News', 'DEV.to'"
                },
                "behavior": {
                  "type": "string",
                  "description": "How they behave on this platform -- lurker, commenter, poster, searcher"
                },
                "estimated_reach": {
                  "type": "string",
                  "description": "Estimated reach or community size, e.g. '500K subscribers', '~2K active daily'"
                }
              }
            }
          }
        }
      }
    },
    "four_forces_analysis": {
      "type": "object",
      "required": ["push", "pull", "anxiety", "habit"],
      "properties": {
        "push": {
          "type": "array",
          "minItems": 3,
          "items": {
            "type": "string"
          },
          "description": "What is wrong with the current situation -- pain, frustration, limitation driving people to seek change"
        },
        "pull": {
          "type": "array",
          "minItems": 3,
          "items": {
            "type": "string"
          },
          "description": "What attracts them to a solution -- aspiration, possibility, the imagined better future"
        },
        "anxiety": {
          "type": "array",
          "minItems": 3,
          "items": {
            "type": "string"
          },
          "description": "What scares them about buying or switching -- fear, doubt, past failures, trust concerns"
        },
        "habit": {
          "type": "array",
          "minItems": 3,
          "items": {
            "type": "string"
          },
          "description": "What keeps them doing nothing -- inertia, free alternatives, comfort of the status quo"
        }
      }
    },
    "meta_insight": {
      "type": "string",
      "description": "The overarching persona insight -- not a summary of individual personas but the structural observation that connects them all. Why these personas exist in this market right now."
    },
    "decision_ref": {
      "type": "string",
      "description": "Reference to the decision-log output file used as input (filename slug without extension)"
    },
    "signal_scan_ref": {
      "type": "string",
      "description": "Reference to the signal-scan output file used as input (filename slug without extension)"
    },
    "next_step": {
      "type": "string",
      "const": "offer-scope",
      "description": "The next skill in the pipeline -- always 'offer-scope'"
    },
    "next_step_input_hint": {
      "type": "object",
      "required": ["top_persona", "top_decision_point", "willingness_to_pay", "best_channel"],
      "properties": {
        "top_persona": {
          "type": "string",
          "description": "The persona with the strongest pain + highest WTP -- the best first target for offer-scope"
        },
        "top_decision_point": {
          "type": "object",
          "required": ["trigger", "stuck_behavior", "success_behavior", "product_intervention"],
          "properties": {
            "trigger": {
              "type": "string",
              "description": "The trigger from the top decision point"
            },
            "stuck_behavior": {
              "type": "string",
              "description": "What stuck people do"
            },
            "success_behavior": {
              "type": "string",
              "description": "What successful people do"
            },
            "product_intervention": {
              "type": "string",
              "description": "The recommended product intervention"
            }
          }
        },
        "willingness_to_pay": {
          "type": "object",
          "required": ["range", "evidence", "anchor_products"],
          "properties": {
            "range": {
              "type": "string",
              "description": "WTP range for the top persona"
            },
            "evidence": {
              "type": "string",
              "description": "SPEND data supporting the WTP range"
            },
            "anchor_products": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Products this persona already pays for"
            }
          }
        },
        "best_channel": {
          "type": "object",
          "required": ["platform", "behavior", "estimated_reach"],
          "properties": {
            "platform": {
              "type": "string",
              "description": "The platform where the top persona is most reachable"
            },
            "behavior": {
              "type": "string",
              "description": "How they behave on that platform"
            },
            "estimated_reach": {
              "type": "string",
              "description": "Estimated reach on that platform"
            }
          }
        }
      }
    }
  }
}
